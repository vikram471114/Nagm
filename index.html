<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;800&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #f1f5f9; /* Slate-100 */
            color: #334155; /* Slate-700 */
        }

        /* Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© */
        .glass-header {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid #e2e8f0;
            position: sticky;
            top: 0;
            z-index: 50;
        }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        .stat-card {
            background: white;
            border-radius: 1rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s, box-shadow 0.2s;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-color: #cbd5e1;
        }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù„ÙˆÙ†Ø© (Ø§Ù„Ø±Ù‚Ù…ÙŠØ©) */
        .summary-card { position: relative; color: white; border: none; }
        .summary-card.blue { background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .summary-card.purple { background: linear-gradient(135deg, #a855f7, #7c3aed); }
        .summary-card.emerald { background: linear-gradient(135deg, #10b981, #059669); }
        
        .summary-overlay {
            position: absolute; top: -10px; left: -10px; font-size: 6rem; opacity: 0.15; transform: rotate(15deg);
        }

        /* Ø±Ø£Ø³ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ© */
        .card-header {
            padding: 1.25rem;
            background-color: #f8fafc;
            border-bottom: 1px solid #f1f5f9;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .card-icon {
            width: 36px; height: 36px; border-radius: 8px;
            display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
        }

        /* Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… */
        .ranking-list { padding: 0; margin: 0; list-style: none; }
        .ranking-item {
            padding: 0.75rem 1.25rem;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #f1f5f9;
        }
        .ranking-item:last-child { border-bottom: none; }
        .ranking-badge {
            width: 24px; height: 24px; background: #e2e8f0; color: #64748b;
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 0.75rem; font-weight: bold; margin-left: 0.5rem;
        }
        .ranking-item:first-child .ranking-badge { background: #fef3c7; color: #d97706; }

        /* Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
        .custom-table th { background-color: #f8fafc; color: #475569; font-weight: 700; text-align: right; padding: 1rem; }
        .custom-table td { padding: 1rem; border-bottom: 1px solid #f1f5f9; }
        .custom-table tr:hover { background-color: #f8fafc; }
        
        /* Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© */
        .status-badge { padding: 0.25rem 0.75rem; border-radius: 9999px; font-size: 0.75rem; font-weight: 700; }
        .status-finished { background-color: #dcfce7; color: #166534; }
        .status-scheduled { background-color: #f1f5f9; color: #64748b; }

        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙØ§Ø¦Ø²ÙŠÙ† */
        details summary { list-style: none; cursor: pointer; color: #2563eb; font-weight: 600; display: inline-flex; align-items: center; gap: 0.5rem; }
        details summary:hover { text-decoration: underline; }
        details summary::-webkit-details-marker { display: none; }
        .winners-dropdown {
            margin-top: 0.5rem; padding: 0.75rem; background: #eff6ff;
            border: 1px solid #dbeafe; border-radius: 0.5rem; font-size: 0.9rem; color: #1e40af;
        }

        /* Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loader-dots div { animation: loader 0.6s infinite alternate; }
        @keyframes loader { to { opacity: 0.3; transform: scale(0.5); } }
        
        /* Ø§Ù„ÙÙ„ØªØ± Ø§Ù„Ù†Ø´Ø· */
        .filter-btn.active { background-color: #2563eb; color: white; border-color: #2563eb; }

    </style>
</head>
<body class="bg-slate-50">

    <header class="glass-header">
        <div class="max-w-7xl mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center gap-4">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center text-white text-2xl shadow-lg shadow-blue-200">ğŸ“ˆ</div>
                <div>
                    <h1 class="text-2xl font-bold text-slate-800 leading-tight">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
                    <p id="period-label" class="text-sm text-slate-500 font-medium">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p>
                </div>
            </div>
            
            <div class="flex items-center gap-2 bg-white p-1.5 rounded-xl border border-slate-200 shadow-sm">
                <button id="week-btn" class="filter-btn active px-4 py-2 rounded-lg text-sm font-bold text-slate-600 hover:bg-slate-50 transition">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</button>
                <button id="today-btn" class="filter-btn px-4 py-2 rounded-lg text-sm font-bold text-slate-600 hover:bg-slate-50 transition">Ø§Ù„ÙŠÙˆÙ…</button>
                <div class="w-px h-6 bg-slate-200 mx-2"></div>
                <input type="date" id="custom-date" class="border-0 bg-slate-50 rounded-md text-sm px-2 py-1.5 focus:ring-2 focus:ring-blue-500">
                <button id="filter-btn" class="bg-slate-800 text-white p-2 rounded-lg hover:bg-slate-700 transition">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                </button>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-8 space-y-12">

        <div id="loader" class="py-20 text-center">
            <div class="loader-dots flex justify-center gap-1 mb-4"><div class="w-3 h-3 bg-blue-500 rounded-full"></div><div class="w-3 h-3 bg-blue-500 rounded-full" style="animation-delay:0.1s"></div><div class="w-3 h-3 bg-blue-500 rounded-full" style="animation-delay:0.2s"></div></div>
            <p class="text-slate-400 font-medium">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
        </div>

        <div id="error-message" class="hidden bg-red-50 text-red-600 p-4 rounded-xl border border-red-100 flex items-center gap-3">
            <svg class="w-6 h-6 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            <span id="error-text">Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹</span>
        </div>

        <div id="content-container" class="hidden space-y-12">

            <section class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="stat-card summary-card blue p-6">
                    <div class="summary-overlay">ğŸ‘¥</div>
                    <div class="relative z-10">
                        <p class="text-blue-100 font-medium text-sm uppercase tracking-wide mb-1">Ø§Ù„Ù…Ø´ØªØ±ÙƒÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ† (Ø§Ù„ÙŠÙˆÙ…)</p>
                        <h2 id="activeUsersToday" class="text-4xl font-bold">--</h2>
                    </div>
                </div>
                <div class="stat-card summary-card purple p-6">
                    <div class="summary-overlay">ğŸ—“ï¸</div>
                    <div class="relative z-10">
                        <p class="text-purple-100 font-medium text-sm uppercase tracking-wide mb-1">Ø§Ù„Ù…Ø´ØªØ±ÙƒÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ† (Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹)</p>
                        <h2 id="activeUsersWeek" class="text-4xl font-bold">--</h2>
                    </div>
                </div>
                <div class="stat-card summary-card emerald p-6">
                    <div class="summary-overlay">â­</div>
                    <div class="relative z-10">
                        <p class="text-emerald-100 font-medium text-sm uppercase tracking-wide mb-1">Ù…ØªÙˆØ³Ø· Ø§Ù„Ù†Ù‚Ø§Ø·</p>
                        <h2 id="averagePointsToday" class="text-4xl font-bold">--</h2>
                    </div>
                </div>
            </section>

            <section>
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-slate-800 flex items-center gap-2">
                        <span class="w-1 h-6 bg-blue-600 rounded-full"></span>
                        Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬
                    </h2>
                    <span class="text-sm text-slate-500 bg-white px-3 py-1 rounded-full border shadow-sm">ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</span>
                </div>

                <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm custom-table">
                            <thead>
                                <tr>
                                    <th class="w-1/6">Ø§Ù„Ø¨Ø·ÙˆÙ„Ø©</th>
                                    <th class="w-1/3">Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©</th>
                                    <th class="w-1/6 text-center">Ø§Ù„Ù†ØªÙŠØ¬Ø©</th>
                                    <th class="w-1/3">Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©</th>
                                </tr>
                            </thead>
                            <tbody id="matches-table-body">
                                </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <section>
                <h2 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                    <span class="w-1 h-6 bg-yellow-500 rounded-full"></span>
                    Ø£Ø³Ø§Ø·ÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div id="starsOfPeriod" class="stat-card"></div>
                    <div id="bigMatchHuntersByPoints" class="stat-card"></div>
                    <div id="bigMatchHuntersByCount" class="stat-card"></div>
                    <div id="highScorers" class="stat-card"></div>
                    <div id="longestStreak" class="stat-card"></div>
                    <div id="mostConsistent" class="stat-card"></div>
                </div>
            </section>

            <section>
                <h2 class="text-xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                    <span class="w-1 h-6 bg-rose-500 rounded-full"></span>
                    Ø£Ø¨Ø·Ø§Ù„ Ø§Ù„Ø¯ÙˆØ±ÙŠØ§Øª Ø§Ù„ÙƒØ¨Ø±Ù‰
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div id="league-Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ" class="stat-card border-t-4 border-t-indigo-500"></div>
                    <div id="league-Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ" class="stat-card border-t-4 border-t-orange-500"></div>
                    <div id="league-Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§" class="stat-card border-t-4 border-t-blue-800"></div>
                    <div id="league-Ø¯ÙˆØ±ÙŠ Ø±ÙˆØ´Ù† Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ" class="stat-card border-t-4 border-t-green-600"></div>
                    <div id="league-Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ" class="stat-card border-t-4 border-t-sky-500"></div>
                    <div id="league-Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ" class="stat-card border-t-4 border-t-red-600"></div>
                    <div id="league-Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ" class="stat-card border-t-4 border-t-blue-400"></div>
                </div>
            </section>

        </div>
    </main>

    <footer class="border-t border-slate-200 bg-white py-8 mt-auto">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-slate-500 text-sm font-medium">Â© 2025 Ù†Ø¸Ø§Ù… ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø°ÙƒÙŠ</p>
        </div>
    </footer>

    <script>
        // =======================
        // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        // =======================
        const BASE_URL = 'https://nagm.onrender.com/api/v1/stats';
        const LOADER = document.getElementById('loader');
        const CONTENT = document.getElementById('content-container');
        const ERROR_MSG = document.getElementById('error-message');
        const PERIOD_LABEL = document.getElementById('period-label');

        const LEAGUE_NAMES = [
            "Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ", "Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠ", "Ø¯ÙˆØ±ÙŠ Ø£Ø¨Ø·Ø§Ù„ Ø£ÙˆØ±ÙˆØ¨Ø§", "Ø¯ÙˆØ±ÙŠ Ø±ÙˆØ´Ù† Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠ",
            "Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø¥ÙŠØ·Ø§Ù„ÙŠ", "Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ", "Ø§Ù„Ø¯ÙˆØ±ÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠ"
        ];

        // ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª (Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙˆØ£Ù„ÙˆØ§Ù†)
        const CARD_CONFIG = {
            'starsOfPeriod': { title: 'Ù†Ø¬Ù… Ø§Ù„ÙØªØ±Ø©', icon: 'â­', bg: 'bg-yellow-50', text: 'text-yellow-600' },
            'bigMatchHuntersByPoints': { title: 'Ù‚Ù†Ø§Øµ Ø§Ù„Ù‚Ù…Ù… (Ù†Ù‚Ø§Ø·)', icon: 'ğŸ¯', bg: 'bg-red-50', text: 'text-red-600' },
            'bigMatchHuntersByCount': { title: 'Ù‚Ù†Ø§Øµ Ø§Ù„Ù‚Ù…Ù… (Ø¹Ø¯Ø¯)', icon: 'ğŸ”¢', bg: 'bg-orange-50', text: 'text-orange-600' },
            'highScorers': { title: 'Ø£Ø¹Ù„Ù‰ Ø±ØµÙŠØ¯ Ø¨Ù…Ø¨Ø§Ø±Ø§Ø©', icon: 'ğŸ”¥', bg: 'bg-purple-50', text: 'text-purple-600' },
            'longestStreak': { title: 'Ø£Ø·ÙˆÙ„ Ø³Ù„Ø³Ù„Ø© ØµØ­ÙŠØ­Ø©', icon: 'âš¡', bg: 'bg-blue-50', text: 'text-blue-600' },
            'mostConsistent': { title: 'Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø´Ø§Ø±ÙƒØ©', icon: 'ğŸ›¡ï¸', bg: 'bg-emerald-50', text: 'text-emerald-600' }
        };

        // =======================
        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
        // =======================
        const showLoader = () => { LOADER.classList.remove('hidden'); CONTENT.classList.add('hidden'); ERROR_MSG.classList.add('hidden'); };
        const hideLoader = () => LOADER.classList.add('hidden');
        const showError = (msg) => { hideLoader(); document.getElementById('error-text').textContent = msg; ERROR_MSG.classList.remove('hidden'); };

        // Ø¯Ø§Ù„Ø© Ø±Ø³Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
        function renderCard(elementId, leagueName, items, unit) {
            const container = document.getElementById(elementId);
            if (!container) return;

            let config = { title: leagueName, icon: 'ğŸ†', bg: 'bg-slate-100', text: 'text-slate-600' };
            if (CARD_CONFIG[elementId]) config = CARD_CONFIG[elementId];

            let content = '';
            if (!items || items.length === 0 || items[0].name === 'Ù„Ø§ ÙŠÙˆØ¬Ø¯') {
                content = `<div class="p-6 text-center text-slate-400 text-sm">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</div>`;
            } else {
                content = '<ul class="ranking-list">';
                items.forEach((item, index) => {
                    const val = item.points ?? item.correct ?? item.count ?? item.total ?? 0;
                    content += `
                        <li class="ranking-item">
                            <div class="flex items-center">
                                <span class="ranking-badge">${index + 1}</span>
                                <span class="font-semibold text-slate-700 mr-2">${item.name}</span>
                            </div>
                            <span class="bg-blue-50 text-blue-700 px-2 py-1 rounded text-xs font-bold">${val} ${unit}</span>
                        </li>
                    `;
                });
                content += '</ul>';
            }

            container.innerHTML = `
                <div class="card-header">
                    <div class="card-icon ${config.bg} ${config.text}">${config.icon}</div>
                    <h3 class="font-bold text-slate-700">${config.title}</h3>
                </div>
                ${content}
            `;
        }

        // =======================
        // Ø§Ù„Ø¬Ù„Ø¨ ÙˆØ§Ù„Ø±Ø³Ù…
        // =======================
        
        // 1. Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
        async function fetchGeneralStats(query) {
            const res = await fetch(`${BASE_URL}${query}`);
            const json = await res.json();
            const d = json.data;

            PERIOD_LABEL.textContent = d.period;
            document.getElementById('activeUsersToday').textContent = d.activeUsersToday;
            document.getElementById('activeUsersWeek').textContent = d.activeUsersWeek;
            document.getElementById('averagePointsToday').textContent = d.averagePointsToday;

            // Ø±Ø³Ù… Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
            renderCard('starsOfPeriod', null, d.starsOfPeriod, 'Ù†Ù‚Ø·Ø©');
            renderCard('bigMatchHuntersByPoints', null, d.bigMatchHuntersByPoints, 'Ù†Ù‚Ø·Ø©');
            renderCard('bigMatchHuntersByCount', null, d.bigMatchHuntersByCount, 'Ù…Ø¨Ø§Ø±Ø§Ø©');
            renderCard('highScorers', null, d.highScorers, 'Ù†Ù‚Ø·Ø©');
            renderCard('longestStreak', null, d.longestStreak, 'ØªÙˆÙ‚Ø¹');
            renderCard('mostConsistent', null, d.mostConsistent, 'ØªÙˆÙ‚Ø¹');

            LEAGUE_NAMES.forEach(name => {
                renderCard(`league-${name}`, name, d.leagueStars[name], 'Ù†Ù‚Ø·Ø©');
            });
        }

        // 2. Ø¬Ù„Ø¨ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª
        async function fetchMatches(query) {
            const res = await fetch(`${BASE_URL}/matches${query}`);
            const json = await res.json();
            const tbody = document.getElementById('matches-table-body');
            tbody.innerHTML = '';

            if (json.data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" class="p-8 text-center text-slate-400">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¨Ø§Ø±ÙŠØ§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØªØ±Ø©</td></tr>';
                return;
            }

            json.data.forEach(m => {
                const isPlayed = m.resultFormatted.trim() !== "-";
                
                let winners = '';
                if (!isPlayed) winners = '<span class="text-slate-400 text-xs">Ù‚Ø±ÙŠØ¨Ø§Ù‹</span>';
                else if (m.winnersCount > 0) {
                    winners = `
                        <details class="relative">
                            <summary class="text-sm">ğŸ‰ ${m.winnersCount} ÙØ§Ø¦Ø²</summary>
                            <div class="winners-dropdown">
                                ${m.winnersList.join(' ØŒ ')}
                            </div>
                        </details>
                    `;
                } else {
                    winners = '<span class="text-red-400 text-xs">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙØ§Ø¦Ø²</span>';
                }

                const statusClass = isPlayed ? 'status-finished' : 'status-scheduled';
                const row = `
                    <tr class="match-row">
                        <td><span class="text-xs font-bold bg-slate-100 text-slate-600 px-2 py-1 rounded">${m.league}</span></td>
                        <td>
                            <div class="flex items-center gap-2">
                                <span class="font-bold text-slate-700">${m.teamA}</span>
                                <span class="text-slate-300 text-xs">VS</span>
                                <span class="font-bold text-slate-700">${m.teamB}</span>
                            </div>
                        </td>
                        <td class="text-center">
                            <span class="font-mono font-bold text-lg ${isPlayed ? 'text-blue-600' : 'text-slate-300'}">${m.resultFormatted}</span>
                        </td>
                        <td>${winners}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // =======================
        // Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
        // =======================
        async function loadAll(query = '') {
            showLoader();
            try {
                await Promise.all([fetchGeneralStats(query), fetchMatches(query)]);
                hideLoader();
                CONTENT.classList.remove('hidden');
            } catch (err) {
                console.error(err);
                showError('ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±. ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
            }
        }

        // Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        document.addEventListener('DOMContentLoaded', () => {
            loadAll(''); // ØªØ­Ù…ÙŠÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ

            const btns = document.querySelectorAll('.filter-btn');
            btns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    btns.forEach(b => b.classList.remove('active', 'bg-blue-600', 'text-white'));
                    btns.forEach(b => b.classList.add('text-slate-600', 'hover:bg-slate-50'));
                    
                    e.target.classList.add('active', 'bg-blue-600', 'text-white');
                    e.target.classList.remove('text-slate-600', 'hover:bg-slate-50');

                    const period = e.target.id === 'today-btn' ? '?period=today' : '';
                    document.getElementById('custom-date').value = '';
                    loadAll(period);
                });
            });

            document.getElementById('filter-btn').addEventListener('click', () => {
                const date = document.getElementById('custom-date').value;
                if(date) {
                    btns.forEach(b => b.classList.remove('active', 'bg-blue-600', 'text-white'));
                    loadAll(`?date=${date}`);
                }
            });
        });

    </script>
</body>
</html>
